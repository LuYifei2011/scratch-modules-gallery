<!DOCTYPE html>
<html lang="{{ config.language }}">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>
      {% block title %}
        {{ config.siteName }}
      {% endblock %}
    </title>
    <meta name="description" content="{% block meta_description %}{{ config.description }}{% endblock %}"/>
    {% block meta_keywords %}<meta name="keywords" content="{{ config.keywords or '' }}"/>{% endblock %}
    <meta name="darkreader-lock" content="true"/>
    <meta name="theme-color" content="#1747a6" media="(prefers-color-scheme: light)">
    <meta
    name="theme-color" content="#0d1e33" media="(prefers-color-scheme: dark)"> {# basePath: 由构建脚本解析 config.baseUrl pathname, 例如 "/scratch-modules-gallery" 或 "" #}
    <link rel="canonical" href="{{ config.baseUrl }}{{ canonical or '/' }}"/>
    <link rel="stylesheet" href="{{ basePath }}/style.css"/>
    <script defer src="{{ basePath }}/vendor/minisearch.js"></script>
    <script defer src="{{ basePath }}/vendor/scratchblocks.min.js"></script>
    <script defer src="{{ basePath }}/vendor/scratchblocks-translations.js"></script>
    {% block head_extra %}{% endblock %}
  </head>
  <body>
    <header>
      {# 统一使用 .site-title 容器，样式在 CSS 中处理（保持与原先 h1 外观一致） #}
      <div class="site-title">
        <a href="{{ basePath }}/">{{ config.siteName }}</a>
      </div>
      {# 当渲染首页时，构建脚本会传入 modules 列表；仅在 modules 可用且不是单个 module 页面时显示站点总数 #}
      {% if modules is defined and not module %}
        <p class="site-module-count">站点共有 {{ modules | length }} 个模块</p>
      {% endif %}
      {% if IS_DEV %}
        <div style="color: grey;">(debug)</div>
      {% endif %}
      <nav class="top-actions">
        {% if config.repoUrl %}
          <a class="gh-btn" href="{% if module %}{{ config.repoUrl }}/tree/{{ config.repoBranch | default('main') }}/{{ config.contentDir }}/{{ module.slug }}{% else %}{{ config.repoUrl }}{% endif %}" target="_blank" rel="noopener" aria-label="GitHub 仓库">
            <svg viewbox="0 0 16 16" width="18" height="18" aria-hidden="true" focusable="false"><path
                fill="currentColor"
                d="M8 .2a8 8 0 0 0-2.53
                  15.59c.4.07.55-.17.55-.38l-.01-1.33c-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01
                  1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95
                  0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82a7.5 7.5 0 0 1 2-.27 7.5 7.5 0 0 1 2 .27c1.53-1.04
                  2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48l-.01 2.2c0
                  .21.15.45.55.38A8 8 0 0 0 8 .2Z"/>
            </svg>
            <span class="label">GitHub</span>
          </a>
        {% endif %}
      </nav>
    </header>
    <main>
      {% block content %}{% endblock %}
    </main>
    <footer>
      <p>&copy; {{ year }} Scratch Modules Gallery</p>
    </footer>
    {# 将构建时的 IS_DEV 暴露给前端 JS #}
    <script>
      window.IS_DEV = {% if IS_DEV %}
        true
      {% else %}
        false
      {% endif %};
    </script>
    {# 页面可在此注入页面专用脚本/样式。模板会在需要时覆盖该块。 #}
    {% block page_scripts %}{% endblock %}
  </body>
</html>