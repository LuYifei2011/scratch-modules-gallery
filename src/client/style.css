/* ===== 设计令牌系统 (Design Tokens) ===== */
:root {
  /* 基础颜色 */
  --color-bg-primary: #f7f9fb;
  --color-bg-secondary: #fff;
  --color-text-primary: #222;
  --color-text-secondary: #666;
  --color-text-tertiary: #999;

  /* 语义颜色 */
  --color-brand: #1747a6;
  --color-brand-hover: #0d3180;
  --color-primary: #4c97ff; /* Scratch 蓝 - 主要操作色 */
  --color-success: #2ecc71;
  --color-warning: #d8b200;
  --color-error: #e33;

  /* 边框 */
  --color-border-light: #e3e7ee;
  --color-border-medium: #dfe2e7;
  --color-border-dark: #ccc;

  /* 组件颜色 */
  --color-tag-bg: #e1ecf4;
  --color-tag-text: #0366d6;
  --color-badge-bg: #ffb347;
  --color-badge-text: #222;
  --color-github: #24292f;

  /* 排版系统 */
  --font-family-base:
    system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
    sans-serif;
  --font-family-mono: 'Consolas', 'Monaco', 'Courier New', monospace;

  --font-size-xs: 0.65rem; /* 10.4px */
  --font-size-sm: 0.75rem; /* 12px */
  --font-size-base: 0.875rem; /* 14px */
  --font-size-md: 1rem; /* 16px */
  --font-size-lg: 1.1rem; /* 17.6px */
  --font-size-xl: 1.25rem; /* 20px */

  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;

  --line-height-tight: 1.2;
  --line-height-normal: 1.5;
  --line-height-relaxed: 1.75;

  /* 间距系统 */
  --space-xs: 0.25rem; /* 4px */
  --space-sm: 0.5rem; /* 8px */
  --space-md: 0.75rem; /* 12px */
  --space-lg: 1rem; /* 16px */
  --space-xl: 1.5rem; /* 24px */
  --space-2xl: 2rem; /* 32px */
  --space-3xl: 3rem; /* 48px */

  /* 圆角系统 */
  --radius-sm: 4px;
  --radius-md: 6px;
  --radius-lg: 8px;
  --radius-xl: 12px;

  /* 阴影系统 */
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08);
  --shadow-md: 0 2px 8px rgba(0, 0, 0, 0.1);
  --shadow-lg: 0 4px 20px rgba(0, 0, 0, 0.15);

  /* 过渡动画 */
  --transition-fast: 120ms ease;
  --transition-base: 160ms ease;
  --transition-slow: 240ms ease;

  /* 层级系统 */
  --z-dropdown: 100;
  --z-sticky: 100;
  --z-modal-backdrop: 1000;
  --z-modal: 2000;

  /* 响应式断点 (用于文档，CSS变量不能直接用于media query) */
  --breakpoint-sm: 520px;
  --breakpoint-md: 768px;
  --breakpoint-lg: 960px;
  --breakpoint-xl: 1200px;

  /* TODO 向后兼容的别名 考虑移除？ */
  --bg: var(--color-bg-primary);
  --text: var(--color-text-primary);
  --panel: var(--color-bg-secondary);
  --panel-border: var(--color-border-light);
  --panel-border-strong: var(--color-border-medium);
  --accent: var(--color-brand);
  --accent-hover: var(--color-brand-hover);
  --tag-bg: var(--color-tag-bg);
  --tag-text: var(--color-tag-text);
  --badge-bg: var(--color-badge-bg);
  --badge-text: var(--color-badge-text);
  --shadow: var(--shadow-sm);

  color-scheme: light dark;
}

@media (prefers-color-scheme: dark) {
  :root {
    /* 基础颜色 - 深色模式 */
    --color-bg-primary: #0f1722;
    --color-bg-secondary: #182232;
    --color-text-primary: #e2e8f0;
    --color-text-secondary: #9ca3af;
    --color-text-tertiary: #6b7280;

    /* 语义颜色 - 深色模式 */
    --color-brand: #4da3ff;
    --color-brand-hover: #79bbff;
    --color-primary: #4c97ff;
    --color-success: #2ecc71;
    --color-warning: #ffd54a;
    --color-error: #ff6666;

    /* 边框 - 深色模式 */
    --color-border-light: #263244;
    --color-border-medium: #324156;
    --color-border-dark: #4a5568;

    /* 组件颜色 - 深色模式 */
    --color-tag-bg: #24364b;
    --color-tag-text: #8bc3ff;
    --color-badge-bg: #ffb347;
    --color-badge-text: #222;
    --color-github: #1b1f23;

    /* 阴影 - 深色模式 */
    --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.4);
    --shadow-md: 0 2px 8px rgba(0, 0, 0, 0.3);
    --shadow-lg: 0 4px 20px rgba(0, 0, 0, 0.5);
  }
  img,
  video,
  svg {
    filter: none !important;
  } /* 避免 DarkReader 再次处理，配合 lock */
}
body {
  font-family: var(--font-family-base);
  margin: 0;
  padding: 0;
  background: var(--bg);
  color: var(--text);
  line-height: var(--line-height-normal);
}
header {
  background: var(--panel);
  padding: var(--space-lg) var(--space-xl);
  box-shadow: var(--shadow);
  position: sticky;
  top: 0;
  z-index: var(--z-sticky);
  display: flex;
  align-items: center;
  gap: var(--space-md);
}
footer {
  background: var(--panel);
  padding: var(--space-lg) var(--space-xl);
  box-shadow: var(--shadow);
  position: relative;
}
header h1 {
  font-size: var(--font-size-xl);
  font-weight: var(--font-weight-bold);
  margin: 0;
  display: inline-block;
}
header a {
  text-decoration: none;
  color: var(--accent);
}
/* 图标基础样式 */
.icon {
  fill: none;
  stroke: currentColor;
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
}
/* 当站点标题在模块页面降级为 .site-title 时，保持与 h1 相同的外观 */
.site-title {
  font-size: var(--font-size-xl);
  margin: 0;
  display: inline-block;
  font-weight: var(--font-weight-bold);
}
/* Ensure the link inside site-title matches header h1 link styling */
.site-title a {
  text-decoration: none;
  color: var(--accent);
  font-weight: inherit;
}
/* 把操作按钮放在行尾，这样标题与计数可以在同一行 */
header .top-actions {
  display: flex;
  gap: var(--space-sm);
  align-items: center;
  margin-left: auto;
  position: static;
  transform: none;
}
.gh-btn {
  display: inline-flex;
  align-items: center;
  gap: var(--space-xs);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  background: var(--color-github);
  color: #fff;
  padding: var(--space-sm) var(--space-md);
  border-radius: var(--radius-md);
  text-decoration: none;
  line-height: 1;
  transition: background var(--transition-base);
}
.gh-btn:hover,
.gh-btn:focus {
  background: #000;
}
.gh-btn svg {
  display: block;
}
.gh-btn .label {
  display: none;
}
@media (min-width: 520px) {
  .gh-btn .label {
    display: inline;
  }
}
/* 语言选择器 */
.lang-switch {
  position: relative;
}
.lang-btn {
  display: inline-flex;
  align-items: center;
  gap: var(--space-xs);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  background: var(--color-bg-secondary);
  color: var(--color-text-primary);
  padding: var(--space-sm) var(--space-md);
  border: 1px solid var(--color-border-medium);
  border-radius: var(--radius-md);
  cursor: pointer;
  line-height: 1;
  transition: all var(--transition-base);
}
.lang-btn:hover {
  border-color: var(--color-brand);
  background: var(--color-bg-primary);
}
.lang-btn[aria-expanded='true'] {
  border-color: var(--color-brand);
  background: var(--color-bg-primary);
}
.lang-btn .icon {
  display: block;
  color: var(--color-brand);
}
.lang-current {
  white-space: nowrap;
}
.lang-arrow.icon {
  color: var(--color-text-secondary);
  transition: transform var(--transition-base);
}
.lang-btn[aria-expanded='true'] .lang-arrow {
  transform: rotate(180deg);
}
.lang-menu {
  position: absolute;
  right: 0;
  top: calc(100% + var(--space-xs));
  background: var(--color-bg-secondary);
  border: 1px solid var(--color-border-medium);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-md);
  min-width: 160px;
  padding: var(--space-xs);
  z-index: var(--z-dropdown);
}
.lang-option {
  display: block;
  width: 100%;
  padding: var(--space-sm) var(--space-md);
  text-align: left;
  background: transparent;
  border: none;
  border-radius: var(--radius-sm);
  cursor: pointer;
  font-size: var(--font-size-sm);
  color: var(--color-text-primary);
  transition: background var(--transition-fast);
}
.lang-option:hover {
  background: var(--color-bg-primary);
}
.lang-option-active {
  background: var(--color-tag-bg);
  color: var(--color-tag-text);
  font-weight: var(--font-weight-semibold);
}
.lang-option-active:hover {
  background: var(--color-tag-bg);
}
.lang-divider {
  height: 1px;
  background: var(--color-border-light);
  margin: var(--space-xs) 0;
}
.lang-remember {
  display: flex;
  align-items: center;
  gap: var(--space-xs);
  padding: var(--space-sm) var(--space-md);
  font-size: var(--font-size-sm);
  cursor: pointer;
  user-select: none;
}
.lang-remember input[type='checkbox'] {
  cursor: pointer;
  width: 14px;
  height: 14px;
}
.lang-remember-tooltip {
  display: inline-flex;
  margin-left: auto;
  cursor: help;
}
main {
  max-width: 960px;
  margin: var(--space-xl) auto;
  padding: 0 var(--space-lg);
}
input#search {
  display: block;
  min-width: 200px;
  margin: 0 var(--space-2xl) var(--space-lg) var(--space-2xl);
  padding: var(--space-sm) var(--space-md);
  font-size: var(--font-size-md);
  font-family: var(--font-family-base);
  border: 1px solid var(--panel-border);
  background: var(--panel);
  color: var(--text);
  border-radius: var(--radius-md);
  transition:
    border-color var(--transition-base),
    outline var(--transition-fast);
}
input#search:focus {
  outline: 2px solid var(--accent);
  outline-offset: 1px;
  border-color: var(--accent);
}
/* 响应式网格：自动填充列，卡片最小宽 240px，空间足够时均匀拉伸 */
.module-list {
  display: grid;
  gap: var(--space-lg);
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  align-items: stretch;
}
.module-item {
  background: var(--panel);
  padding: var(--space-lg) var(--space-lg) var(--space-lg);
  border-radius: var(--radius-lg);
  border: 1px solid var(--panel-border);
  display: flex;
  flex-direction: column;
  transition:
    border-color var(--transition-base),
    box-shadow var(--transition-base);
}
.module-item:hover {
  border-color: var(--color-border-medium);
  box-shadow: var(--shadow-md);
}
.module-item p {
  margin-top: 0;
}
.module-item h2 a {
  color: var(--accent);
  text-decoration: none;
}
.module-item h2 a:hover {
  text-decoration: underline;
  color: var(--accent-hover);
}
@media (min-width: 1200px) {
  main {
    max-width: 1200px;
  }
}
.module-item h2 {
  margin: 0 0 var(--space-sm);
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
}
.badge {
  background: var(--badge-bg);
  color: var(--badge-text);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-semibold);
  padding: 2px var(--space-sm);
  border-radius: var(--radius-sm);
  vertical-align: middle;
}
.tags {
  font-size: var(--font-size-sm);
}
.tag {
  display: inline-block;
  background: var(--tag-bg);
  color: var(--tag-text);
  padding: 2px var(--space-sm);
  margin: 2px var(--space-xs) 2px 0;
  border-radius: var(--radius-sm);
  transition: background var(--transition-fast);
}
.tag:hover {
  opacity: 0.8;
}
.module-detail h1 {
  margin-top: 0;
}
.contributors .contributor {
  margin-right: var(--space-sm);
}
footer {
  font-size: var(--font-size-sm);
  text-align: center;
  color: var(--color-text-secondary);
}
/* GitHub 按钮在深色模式中保持原色，仅微调背景 */
@media (prefers-color-scheme: dark) {
  .gh-btn:hover,
  .gh-btn:focus {
    background: #040506;
  }
}
/* 多脚本块布局 */
